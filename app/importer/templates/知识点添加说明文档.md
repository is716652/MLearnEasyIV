# 知识点添加说明文档

目的：用统一模板快速新增“知识点”到数据库，避免命令行与语法踩坑。

目录位置
- 模板与说明文档路径：`app/importer/templates/`
- 模板文件：
  - 模板A（最小可用版）：`template_A.md`
  - 模板B（完整版）：`template_B.md`

快速上手（推荐流程）
1) 在 `app/importer/templates/` 复制一份 `template_A.md` 或 `template_B.md` 到你的工作区并重命名。
2) 编辑 YAML 头部（两行 `---` 之间）：
   - module: 从 `A|B|C` 中保留一个，删除其余两个
   - subcategory: 子类名称（例如：微积分 / 线性代数 / 概率统计 / 监督学习等）
   - title: 标题（必须全局唯一）
   - tags: 可选，必须是 YAML 列表（例如 `[入门, 例子]`）
3) 填写正文（Markdown）：
   - 支持行内公式 `$...$` 与块级公式 `$$...$$`
   - Python 代码块用三反引号包裹并指定语言：```python ... ```
   - 图片：
     - 外链 URL 直接可用：`![alt](https://...)`
     - 本地相对路径：`![alt](images/xxx.png)`，导入时需提供 `base_dir`（该相对路径的绝对根目录）
4) 导入方式（零命令行，推荐Swagger）：
   - 打开 http://localhost:8000/docs
   - 找到 `POST /api/v1/import-md/file`
   - 选择你的 `.md` 文件
   - 若正文含相对图片，填写 `base_dir`（绝对路径）
   - 如需覆盖同名标题，勾选 `overwrite=true`
   - 执行后返回 `status: created | updated | skipped` 与记录 `id/title`

可选：通过 JSON 文本导入
- 端点：`POST /api/v1/import-md/text`
- 请求体：
  - md_text: 你的 Markdown 原文（含 YAML 头）
  - overwrite: 是否覆盖同名标题（默认 false）
  - base_dir: 若正文里用相对图片路径，这里提供该相对路径的绝对根目录
- 建议直接在 Swagger 中找到该接口并粘贴 JSON 进行测试

校验清单（提交前自检）
- YAML 头与尾均为 `---`，放在文档最开头
- module 从 `A|B|C` 中保留一个即可（删除其余）
- subcategory、title 必填；`title` 保持全局唯一
- tags 为列表（如 `[示例, 可删]`），不要写成纯字符串
- 代码块与公式成对闭合：
  - ```python 与 ``` 成对
  - `$$ ... $$` 成对
- 使用相对图片路径时，务必在导入时提供 `base_dir`
- 支持的图片扩展名：.png/.jpg/.jpeg/.gif/.svg

常见问题
- 缺少必填项：解析器会报错 `Missing required fields in frontmatter: ...`
- 标题重复但未覆盖：返回 `skipped`
- 标题重复且覆盖：返回 `updated`
- 图片不显示：多为未提供 `base_dir` 或路径错误

示例片段（仅示意）
```
---
module: A|B|C
subcategory: 线性代数
title: 向量的范数定义
tags: [线性代数, 入门]
---

行内公式：$\|x\|_2 = \sqrt{\sum_i x_i^2}$。

```python
import numpy as np
np.linalg.norm([3,4], ord=2)
```

图片（任选其一）：
- 外链：![norm_chart](https://example.com/norm.png)
- 相对：![norm_chart](images/norm.png)
```

进阶：预检能力（可选需求）
- 如需“先解析校验、后入库”，可以新增预检接口：仅返回将写入的 payload 以及发现的问题，确认无误后再执行导入。若需要请告知，我们可随时添加。