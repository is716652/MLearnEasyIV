import{d as s,r as e,o as a,a as t,c,b as l,t as i,e as o,F as n,f as r,g as u,_ as d}from"./index-CmkI6VHI.js";import{a as v}from"./api.DXzY1WMI.js";const f=d(s({__name:"index",setup(s){const d=e(""),f=e([]),p=e([]),h=e(""),m=e({list:!1,search:!1}),g=e("");function y(){const s=new Date;d.value=s.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}function b(s){s&&(location.href=`#/pages/content/detail?id=${s.id}`)}function w(){const s=document.querySelector(".focus-area"),e=.5*window.pageYOffset;s&&(s.style.transform=`translateY(${e}px)`)}function k(s){if(!s)return"ML";const e=s.toUpperCase();return e.startsWith("MAT")||"MATH"===e?"MA":e.startsWith("DL")?"DL":e.slice(0,2)}function x(s,e=80){if(!s)return"";const a=s.replace(/\n+/g," ");return a.length>e?a.slice(0,e)+"…":a}let C;return a(()=>{y(),C=window.setInterval(y,1e3),window.addEventListener("scroll",w,{passive:!0}),async function(){var s;try{m.value.list=!0;const e=await v.listContents({limit:5});f.value=e,h.value=(null==(s=e[0])?void 0:s.content_body)?x(e[0].content_body,120):""}catch(e){console.error("fetchTopContents error:",e),g.value=(null==e?void 0:e.message)||"拉取内容失败"}finally{m.value.list=!1}}(),async function(){try{m.value.search=!0;const s=await v.search({query:"回归",limit:3});p.value=s.results||[]}catch(s){console.error("fetchSearchSample error:",s)}finally{m.value.search=!1}}()}),t(()=>{C&&window.clearInterval(C),window.removeEventListener("scroll",w)}),(s,e)=>(u(),c("div",{class:"page-wrap"},[l("div",{class:"status-bar"},[l("div",{class:"status-left"},[l("div",{class:"signal-icon"}),l("span",null,"WiFi")]),l("div",{class:"status-right"},[l("span",null,i(d.value),1),l("div",{class:"battery-icon"})])]),l("div",{class:"main-container"},[g.value?(u(),c("div",{key:0,style:{color:"#c0392b",background:"#fdecea",padding:"8px 12px","border-radius":"8px","margin-bottom":"12px"}},i(g.value),1)):o("",!0),l("div",{class:"focus-area"},[l("h2",{class:"focus-title"},"今日重点"),l("p",{class:"focus-content"},i(h.value||(m.value.list?"正在拉取后端数据…":"暂无数据")),1)]),l("div",{class:"course-section"},[l("h3",{class:"section-title"},"推荐课程"),(u(!0),c(n,null,r(f.value,s=>(u(),c("div",{key:s.id,class:"course-card",onClick:e=>b(s)},[l("div",{class:"course-header"},[l("div",{class:"course-badge"},i(k(s.module)),1),l("h4",{class:"course-title"},i(s.title),1)]),l("p",{class:"course-info"}," 模块："+i(s.module)+"｜子类："+i(s.subcategory),1)],8,["onClick"]))),128))]),p.value.length?(u(),c("div",{key:1,class:"course-section"},[l("h3",{class:"section-title"},"搜索结果"),(u(!0),c(n,null,r(p.value,s=>(u(),c("div",{key:"s-"+s.id,class:"course-card",onClick:e=>b(s)},[l("div",{class:"course-header"},[l("div",{class:"course-badge"},i(k(s.module)),1),l("h4",{class:"course-title"},i(s.title),1)]),l("p",{class:"course-info"},i(x(s.content_body)),1)],8,["onClick"]))),128))])):o("",!0)])]))}}),[["__scopeId","data-v-7abcf264"]]);export{f as default};
